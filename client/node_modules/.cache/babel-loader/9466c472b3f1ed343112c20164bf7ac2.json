{"ast":null,"code":"import _objectSpread from\"D:\\\\Work\\\\Projects\\\\web_sheet_node_server\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";import _asyncToGenerator from\"D:\\\\Work\\\\Projects\\\\web_sheet_node_server\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _regeneratorRuntime from\"D:\\\\Work\\\\Projects\\\\web_sheet_node_server\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import Input from\"./../../Custom/FormInput/FormInput\";import{FormProvider}from\"react-hook-form\";import{useForm}from\"react-hook-form\";import axios from\"axios\";import{useDispatch}from\"react-redux\";import{login}from\"../../../redux/app/appActions\";import css from\"./../RegistrationForm/RegistrationForm.module.css\";import{useNavigate}from\"react-router-dom\";import{domain}from\"../../../config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginForm=function LoginForm(){var formMethods=useForm();var dispatch=useDispatch();var navigate=useNavigate();var setError=formMethods.setError,handleSubmit=formMethods.handleSubmit;var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData){var _yield$axios$post,data,_error$response,myError;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post(\"\".concat(domain,\"/auth/login\"),_objectSpread({},formData));case 3:_yield$axios$post=_context.sent;data=_yield$axios$post.data;if(data.response===\"success\"){dispatch(login(data.userId));navigate(\"/user\");}if(data.response===\"fail\")console.log(\"Database error\");_context.next=20;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);myError=_context.t0===null||_context.t0===void 0?void 0:(_error$response=_context.t0.response)===null||_error$response===void 0?void 0:_error$response.data;_context.t1=myError===null||myError===void 0?void 0:myError.cause;_context.next=_context.t1===\"isNotExist\"?15:_context.t1===\"wrongData\"?17:19;break;case 15:setError(myError.field,{type:\"isNotExist\",message:\"\".concat(myError.label,\" \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\")});return _context.abrupt(\"break\",20);case 17:setError(myError.field,{type:\"wrongData\",message:\"\".concat(myError.label,\" \\u043D\\u0435 \\u0432\\u0435\\u0440\\u0435\\u043D\")});return _context.abrupt(\"break\",20);case 19:console.log(\"Неизвестная ошибка\",_context.t0);case 20:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(FormProvider,_objectSpread(_objectSpread({},formMethods),{},{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsxs(\"div\",{className:css.form,children:[/*#__PURE__*/_jsx(Input,{name:\"email\",label:\"Email\"}),/*#__PURE__*/_jsx(Input,{name:\"password\",type:\"password\",label:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:css.submit,children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]})}));};export default LoginForm;","map":{"version":3,"sources":["D:/Work/Projects/web_sheet_node_server/client/src/components/Authorization/LoginForm/LoginForm.jsx"],"names":["Input","FormProvider","useForm","axios","useDispatch","login","css","useNavigate","domain","LoginForm","formMethods","dispatch","navigate","setError","handleSubmit","onSubmit","formData","post","data","response","userId","console","log","myError","cause","field","type","message","label","form","submit"],"mappings":"waAAA,MAAOA,CAAAA,KAAP,KAAkB,oCAAlB,CACA,OAASC,YAAT,KAA6B,iBAA7B,CACA,OAASC,OAAT,KAAwB,iBAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,KAAT,KAAsB,+BAAtB,CACA,MAAOC,CAAAA,GAAP,KAAgB,mDAAhB,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,OAASC,MAAT,KAAuB,iBAAvB,C,wFAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACtB,GAAMC,CAAAA,WAAW,CAAGR,OAAO,EAA3B,CACA,GAAMS,CAAAA,QAAQ,CAAGP,WAAW,EAA5B,CACA,GAAMQ,CAAAA,QAAQ,CAAGL,WAAW,EAA5B,CACA,GAAQM,CAAAA,QAAR,CAAmCH,WAAnC,CAAQG,QAAR,CAAkBC,YAAlB,CAAmCJ,WAAnC,CAAkBI,YAAlB,CAEA,GAAMC,CAAAA,QAAQ,0FAAG,iBAAOC,QAAP,2MAEUb,CAAAA,KAAK,CAACc,IAAN,WAAcT,MAAd,iCAClBQ,QADkB,EAFV,wCAELE,IAFK,mBAELA,IAFK,CAMb,GAAIA,IAAI,CAACC,QAAL,GAAkB,SAAtB,CAAiC,CAC/BR,QAAQ,CAACN,KAAK,CAACa,IAAI,CAACE,MAAN,CAAN,CAAR,CACAR,QAAQ,CAAC,OAAD,CAAR,CACD,CACD,GAAIM,IAAI,CAACC,QAAL,GAAkB,MAAtB,CAA8BE,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAVjB,+EAYPC,OAZO,kEAYG,YAAOJ,QAZV,0CAYG,gBAAiBD,IAZpB,aAcLK,OAdK,SAcLA,OAdK,iBAcLA,OAAO,CAAEC,KAdJ,6BAeN,YAfM,kBAsBN,WAtBM,qBAgBTX,QAAQ,CAACU,OAAO,CAACE,KAAT,CAAgB,CACtBC,IAAI,CAAE,YADgB,CAEtBC,OAAO,WAAKJ,OAAO,CAACK,KAAb,sDAFe,CAAhB,CAAR,CAhBS,2CAuBTf,QAAQ,CAACU,OAAO,CAACE,KAAT,CAAgB,CACtBC,IAAI,CAAE,WADgB,CAEtBC,OAAO,WAAKJ,OAAO,CAACK,KAAb,gDAFe,CAAhB,CAAR,CAvBS,2CA8BTP,OAAO,CAACC,GAAR,CAAY,oBAAZ,cA9BS,oEAAH,kBAARP,CAAAA,QAAQ,4CAAd,CAmCA,mBACE,KAAC,YAAD,gCAAkBL,WAAlB,4BACE,cAAM,QAAQ,CAAEI,YAAY,CAACC,QAAD,CAA5B,wBACE,aAAK,SAAS,CAAET,GAAG,CAACuB,IAApB,wBACE,KAAC,KAAD,EAAO,IAAI,CAAC,OAAZ,CAAoB,KAAK,CAAC,OAA1B,EADF,cAEE,KAAC,KAAD,EAAO,IAAI,CAAC,UAAZ,CAAuB,IAAI,CAAC,UAA5B,CAAuC,KAAK,CAAC,sCAA7C,EAFF,GADF,cAME,eAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAEvB,GAAG,CAACwB,MAArC,4CANF,GADF,GADF,CAcD,CAvDD,CAyDA,cAAerB,CAAAA,SAAf","sourcesContent":["import Input from \"./../../Custom/FormInput/FormInput\";\r\nimport { FormProvider } from \"react-hook-form\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport axios from \"axios\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { login } from \"../../../redux/app/appActions\";\r\nimport css from \"./../RegistrationForm/RegistrationForm.module.css\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { domain } from \"../../../config\";\r\n\r\nconst LoginForm = () => {\r\n  const formMethods = useForm();\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const { setError, handleSubmit } = formMethods;\r\n\r\n  const onSubmit = async (formData) => {\r\n    try {\r\n      const { data } = await axios.post(`${domain}/auth/login`, {\r\n        ...formData,\r\n      });\r\n\r\n      if (data.response === \"success\") {\r\n        dispatch(login(data.userId));\r\n        navigate(\"/user\");\r\n      }\r\n      if (data.response === \"fail\") console.log(\"Database error\");\r\n    } catch (error) {\r\n      const myError = error?.response?.data;\r\n\r\n      switch (myError?.cause) {\r\n        case \"isNotExist\":\r\n          setError(myError.field, {\r\n            type: \"isNotExist\",\r\n            message: `${myError.label} не найден`,\r\n          });\r\n          break;\r\n\r\n        case \"wrongData\":\r\n          setError(myError.field, {\r\n            type: \"wrongData\",\r\n            message: `${myError.label} не верен`,\r\n          });\r\n          break;\r\n\r\n        default:\r\n          console.log(\"Неизвестная ошибка\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <FormProvider {...formMethods}>\r\n      <form onSubmit={handleSubmit(onSubmit)}>\r\n        <div className={css.form}>\r\n          <Input name=\"email\" label=\"Email\" />\r\n          <Input name=\"password\" type=\"password\" label=\"Пароль\" />\r\n        </div>\r\n\r\n        <button type=\"submit\" className={css.submit}>\r\n          Войти\r\n        </button>\r\n      </form>\r\n    </FormProvider>\r\n  );\r\n};\r\n\r\nexport default LoginForm;\r\n"]},"metadata":{},"sourceType":"module"}