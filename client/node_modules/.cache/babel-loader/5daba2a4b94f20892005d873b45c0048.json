{"ast":null,"code":"import _slicedToArray from\"D:\\\\Work\\\\Projects\\\\web_sheet_node_server\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import{useEffect,useState}from\"react\";import{useDispatch}from\"react-redux\";import{useSelector}from\"react-redux\";import{Navigate,useParams}from\"react-router-dom\";import{withAuth}from\"../hoc/withAuth\";import css from\"./Profile.module.css\";import{getOneUser}from\"../../redux/user/userActions\";import{loadMainDate}from\"../../redux/calendar/calendarActions\";import WorkshiftItem from\"./WorkshiftItem/WorkshiftItem\";import InfoBlock from\"./InfoBlock/InfoBlock\";import{domain}from\"../../config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ProfileContent=function ProfileContent(){var dispatch=useDispatch();var _useParams=useParams(),id=_useParams.id;var _useSelector=useSelector(function(state){return state.app;}),userId=_useSelector.userId;var _useSelector2=useSelector(function(state){return state.calendar;}),workShifts=_useSelector2.workShifts;var _useSelector3=useSelector(function(state){return state.user;}),userData=_useSelector3.userData,personId=_useSelector3.personId;var firstName=userData.firstName,lastName=userData.lastName,username=userData.username,profileImage=userData.profileImage;var _useState=useState(),_useState2=_slicedToArray(_useState,2),sortedWorkShifts=_useState2[0],setSortedWorkShifts=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),imagePath=_useState4[0],setImagePath=_useState4[1];useEffect(function(){var path=\"\".concat(domain,\"/static/ProfileImages\");if(profileImage){return setImagePath(\"url('https://ucarecdn.com/\".concat(profileImage,\"')\"));}setImagePath(\"url('\".concat(path,\"/default_user.png')\"));},[profileImage]);useEffect(function(){var sorted=workShifts.filter(function(item){var now=new Date();var date=new Date(item.date);var oneDay=86400000;if(date-now+oneDay>0)return true;return false;});var workshiftItems=sorted.slice(0,3).map(function(item){var shiftTime=item.shiftTime,shiftProp=item.shiftProp,date=item.date;return/*#__PURE__*/_jsx(WorkshiftItem,{wsDate:date,wsTime:shiftTime+shiftProp},date);});setSortedWorkShifts(workshiftItems);},[workShifts,dispatch]);useEffect(function(){dispatch(loadMainDate(personId));},[personId,dispatch]);useEffect(function(){dispatch(getOneUser(userId));},[dispatch,userId]);if(!id)return/*#__PURE__*/_jsx(Navigate,{to:userId});return/*#__PURE__*/_jsxs(\"div\",{className:css.container,children:[/*#__PURE__*/_jsxs(\"div\",{className:css.header,children:[/*#__PURE__*/_jsx(\"div\",{className:css.imgSection,children:/*#__PURE__*/_jsx(\"div\",{className:css.imgCover,style:{backgroundImage:imagePath}})}),/*#__PURE__*/_jsxs(\"div\",{className:css.mainInfo,children:[/*#__PURE__*/_jsx(\"p\",{className:css.name,children:firstName+\" \"+lastName}),/*#__PURE__*/_jsx(\"p\",{className:css.username,children:username})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:css.bodyContainer,children:[/*#__PURE__*/_jsxs(\"div\",{className:css.soonWorkshifts,children:[/*#__PURE__*/_jsx(\"div\",{className:css.soonWorkshifts_header,children:\"\\u0411\\u041B\\u0418\\u0416\\u0410\\u0419\\u0428\\u0418\\u0415 \\u0420\\u0410\\u0411\\u041E\\u0427\\u0418\\u0415 \\u0414\\u041D\\u0418\"}),/*#__PURE__*/_jsx(\"div\",{className:css.soonWorkshifts_body,children:sortedWorkShifts!==null&&sortedWorkShifts!==void 0&&sortedWorkShifts.length?sortedWorkShifts:/*#__PURE__*/_jsx(\"p\",{className:css.notFound,children:\"\\u041D\\u0430\\u0439\\u0434\\u0438 \\u0441\\u0435\\u0431\\u044F \\u0432 \\u043A\\u0430\\u043B\\u0435\\u043D\\u0434\\u0430\\u0440\\u0435\"})})]}),/*#__PURE__*/_jsx(InfoBlock,{})]})]});};export default withAuth(ProfileContent);","map":{"version":3,"sources":["D:/Work/Projects/web_sheet_node_server/client/src/components/Profile/Profile.jsx"],"names":["useEffect","useState","useDispatch","useSelector","Navigate","useParams","withAuth","css","getOneUser","loadMainDate","WorkshiftItem","InfoBlock","domain","ProfileContent","dispatch","id","state","app","userId","calendar","workShifts","user","userData","personId","firstName","lastName","username","profileImage","sortedWorkShifts","setSortedWorkShifts","imagePath","setImagePath","path","sorted","filter","item","now","Date","date","oneDay","workshiftItems","slice","map","shiftTime","shiftProp","container","header","imgSection","imgCover","backgroundImage","mainInfo","name","bodyContainer","soonWorkshifts","soonWorkshifts_header","soonWorkshifts_body","length","notFound"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { Navigate, useParams } from \"react-router-dom\";\r\nimport { withAuth } from \"../hoc/withAuth\";\r\nimport css from \"./Profile.module.css\";\r\nimport { getOneUser } from \"../../redux/user/userActions\";\r\nimport { loadMainDate } from \"../../redux/calendar/calendarActions\";\r\nimport WorkshiftItem from \"./WorkshiftItem/WorkshiftItem\";\r\nimport InfoBlock from \"./InfoBlock/InfoBlock\";\r\nimport { domain } from \"../../config\";\r\n\r\nconst ProfileContent = () => {\r\n  const dispatch = useDispatch();\r\n  const { id } = useParams();\r\n  const { userId } = useSelector((state) => state.app);\r\n  const { workShifts } = useSelector((state) => state.calendar);\r\n  const { userData, personId } = useSelector((state) => state.user);\r\n  const { firstName, lastName, username, profileImage } = userData;\r\n  const [sortedWorkShifts, setSortedWorkShifts] = useState();\r\n  const [imagePath, setImagePath] = useState();\r\n\r\n  useEffect(() => {\r\n    const path = `${domain}/static/ProfileImages`;\r\n    if (profileImage) {\r\n      return setImagePath(`url('https://ucarecdn.com/${profileImage}')`);\r\n    }\r\n    setImagePath(`url('${path}/default_user.png')`);\r\n  }, [profileImage]);\r\n\r\n  useEffect(() => {\r\n    const sorted = workShifts.filter((item) => {\r\n      const now = new Date();\r\n      const date = new Date(item.date);\r\n      const oneDay = 86400000;\r\n      if (date - now + oneDay > 0) return true;\r\n      return false;\r\n    });\r\n\r\n    const workshiftItems = sorted.slice(0, 3).map((item) => {\r\n      const { shiftTime, shiftProp, date } = item;\r\n      return (\r\n        <WorkshiftItem\r\n          key={date}\r\n          wsDate={date}\r\n          wsTime={shiftTime + shiftProp}\r\n        />\r\n      );\r\n    });\r\n\r\n    setSortedWorkShifts(workshiftItems);\r\n  }, [workShifts, dispatch]);\r\n\r\n  useEffect(() => {\r\n    dispatch(loadMainDate(personId));\r\n  }, [personId, dispatch]);\r\n\r\n  useEffect(() => {\r\n    dispatch(getOneUser(userId));\r\n  }, [dispatch, userId]);\r\n\r\n  if (!id) return <Navigate to={userId} />;\r\n\r\n  return (\r\n    <div className={css.container}>\r\n      <div className={css.header}>\r\n        <div className={css.imgSection}>\r\n          <div\r\n            className={css.imgCover}\r\n            style={{\r\n              backgroundImage: imagePath,\r\n            }}\r\n          ></div>\r\n        </div>\r\n        <div className={css.mainInfo}>\r\n          <p className={css.name}>{firstName + \" \" + lastName}</p>\r\n          <p className={css.username}>{username}</p>\r\n        </div>\r\n      </div>\r\n      <div className={css.bodyContainer}>\r\n        <div className={css.soonWorkshifts}>\r\n          <div className={css.soonWorkshifts_header}>БЛИЖАЙШИЕ РАБОЧИЕ ДНИ</div>\r\n          <div className={css.soonWorkshifts_body}>\r\n            {sortedWorkShifts?.length ? (\r\n              sortedWorkShifts\r\n            ) : (\r\n              <p className={css.notFound}>Найди себя в календаре</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n        <InfoBlock />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withAuth(ProfileContent);\r\n"]},"metadata":{},"sourceType":"module"}