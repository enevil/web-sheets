{"ast":null,"code":"var _jsxFileName = \"D:\\\\Work\\\\websheets\\\\src\\\\components\\\\Recipes\\\\AddRecipeForm\\\\AddRecipeForm.jsx\",\n    _s = $RefreshSig$();\n\nimport { FormProvider, useForm } from \"react-hook-form\";\nimport { useCallback, useState } from \"react\";\nimport css from \"./AddRecipeForm.module.css\";\nimport FormBody from \"./FormBody/FormBody\";\nimport GoBack from \"../../Custom/GoBack/GoBack\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport FormHeader from \"./FormHeader/FormHeader\";\nimport { useSelector } from \"react-redux\";\nimport { useEffect } from \"react\";\nimport { domain } from \"../../../config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst AddRecipeForm = _ref => {\n  _s();\n\n  let {\n    defaultProps\n  } = _ref;\n  const {\n    userId\n  } = useSelector(state => state.app);\n  const formMethods = useForm({\n    defaultValues: defaultProps || {\n      products: [{\n        ingredient: \"\",\n        weightOf: \"\"\n      }]\n    }\n  });\n  const {\n    handleSubmit,\n    reset\n  } = formMethods;\n  const [img, setImg] = useState();\n  const navigate = useNavigate();\n\n  const goBack = () => {\n    navigate(-1);\n  }; // refresh defaultValues\n\n\n  useEffect(() => {\n    reset(defaultProps);\n  }, [defaultProps, reset]);\n  const onFileUpload = useCallback(file => {\n    setImg(`${file.uuid}/-/crop/${file.crop.width}x${file.crop.height}/${file.crop.left},${file.crop.top}/`);\n  }, []);\n\n  const onSubmit = async formData => {\n    try {\n      const {\n        description,\n        name,\n        type,\n        products\n      } = formData;\n      const prepFormData = {\n        description,\n        name,\n        author: userId,\n        type,\n        products,\n        pathImg: img || (defaultProps === null || defaultProps === void 0 ? void 0 : defaultProps.pathImg),\n        id: defaultProps === null || defaultProps === void 0 ? void 0 : defaultProps._id\n      };\n      const endpoint = defaultProps ? \"edit\" : \"add\";\n      const method = defaultProps ? \"put\" : \"post\";\n      const response = await axios({\n        method,\n        url: `${domain}/recipe/${endpoint}`,\n        data: prepFormData\n      });\n      console.log(response);\n      if (response.data.success) goBack();\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"defaultContainer\",\n    children: [/*#__PURE__*/_jsxDEV(GoBack, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FormProvider, { ...formMethods,\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(onSubmit),\n        children: [/*#__PURE__*/_jsxDEV(FormHeader, {\n          img: img,\n          onFileUpload: onFileUpload,\n          oldPreview: defaultProps === null || defaultProps === void 0 ? void 0 : defaultProps.pathImg\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormBody, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: css.submit,\n          children: \"\\u041F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0434\\u0438\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AddRecipeForm, \"Ka5SKANHTLtaUk+wZwayke1r+jI=\", false, function () {\n  return [useSelector, useForm, useNavigate];\n});\n\n_c = AddRecipeForm;\nexport default AddRecipeForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddRecipeForm\");","map":{"version":3,"sources":["D:/Work/websheets/src/components/Recipes/AddRecipeForm/AddRecipeForm.jsx"],"names":["FormProvider","useForm","useCallback","useState","css","FormBody","GoBack","axios","useNavigate","FormHeader","useSelector","useEffect","domain","AddRecipeForm","defaultProps","userId","state","app","formMethods","defaultValues","products","ingredient","weightOf","handleSubmit","reset","img","setImg","navigate","goBack","onFileUpload","file","uuid","crop","width","height","left","top","onSubmit","formData","description","name","type","prepFormData","author","pathImg","id","_id","endpoint","method","response","url","data","console","log","success","error","submit"],"mappings":"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","sourcesContent":["import { FormProvider, useForm } from \"react-hook-form\";\r\nimport { useCallback, useState } from \"react\";\r\n\r\nimport css from \"./AddRecipeForm.module.css\";\r\nimport FormBody from \"./FormBody/FormBody\";\r\nimport GoBack from \"../../Custom/GoBack/GoBack\";\r\nimport axios from \"axios\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport FormHeader from \"./FormHeader/FormHeader\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { useEffect } from \"react\";\r\nimport { domain } from \"../../../config\";\r\n\r\nconst AddRecipeForm = ({ defaultProps }) => {\r\n  const { userId } = useSelector((state) => state.app);\r\n  const formMethods = useForm({\r\n    defaultValues: defaultProps || {\r\n      products: [{ ingredient: \"\", weightOf: \"\" }],\r\n    },\r\n  });\r\n  const { handleSubmit, reset } = formMethods;\r\n  const [img, setImg] = useState();\r\n  const navigate = useNavigate();\r\n  const goBack = () => {\r\n    navigate(-1);\r\n  };\r\n\r\n  // refresh defaultValues\r\n  useEffect(() => {\r\n    reset(defaultProps);\r\n  }, [defaultProps, reset]);\r\n\r\n  const onFileUpload = useCallback((file) => {\r\n    setImg(\r\n      `${file.uuid}/-/crop/${file.crop.width}x${file.crop.height}/${file.crop.left},${file.crop.top}/`\r\n    );\r\n  }, []);\r\n\r\n  const onSubmit = async (formData) => {\r\n    try {\r\n      const { description, name, type, products } = formData;\r\n      const prepFormData = {\r\n        description,\r\n        name,\r\n        author: userId,\r\n        type,\r\n        products,\r\n        pathImg: img || defaultProps?.pathImg,\r\n        id: defaultProps?._id,\r\n      };\r\n      const endpoint = defaultProps ? \"edit\" : \"add\";\r\n      const method = defaultProps ? \"put\" : \"post\";\r\n      const response = await axios({\r\n        method,\r\n        url: `${domain}/recipe/${endpoint}`,\r\n        data: prepFormData,\r\n      });\r\n      console.log(response);\r\n      if (response.data.success) goBack();\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"defaultContainer\">\r\n      <GoBack />\r\n      <FormProvider {...formMethods}>\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n          <FormHeader\r\n            img={img}\r\n            onFileUpload={onFileUpload}\r\n            oldPreview={defaultProps?.pathImg}\r\n          />\r\n          <FormBody />\r\n          <button type=\"submit\" className={css.submit}>\r\n            Подтвердить\r\n          </button>\r\n        </form>\r\n      </FormProvider>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AddRecipeForm;\r\n"]},"metadata":{},"sourceType":"module"}