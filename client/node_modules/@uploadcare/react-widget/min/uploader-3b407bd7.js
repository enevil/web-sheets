import{_ as n,a as e,b as r,c as t,d as o}from"./index-40ac8f68.js";import a,{useRef as u,useEffect as l,useCallback as c,useImperativeHandle as i}from"react";import d from"uploadcare-widget/uploadcare.min";import{u as f,a as s}from"./use-deep-effect-f86d075a.js";import p from"react-fast-compare";import"@uploadcare/client-suspense";var C=function(n){var e=function(n){var e=u(n);return l((function(){e.current=n}),[n]),e}(n);return c((function(){return e.current&&e.current.apply(e,arguments)}),[e])};var A=function(d,A){var L=d.id,v=d.name,m=d.value,g=d.onFileSelect,E=d.onChange,O=d.onDialogOpen,w=d.onDialogClose,R=d.onTabChange,U=d.apiRef,_=d.customTabs,D=d.validators,h=d.tabsCss,P=d.locale,b=d.localeTranslations,T=d.localePluralize,I=d.previewUrlCallback,S=e(d,["id","name","value","onFileSelect","onChange","onDialogOpen","onDialogClose","onTabChange","apiRef","customTabs","validators","tabsCss","locale","localeTranslations","localePluralize","previewUrlCallback"]),N=u(null),j=u(null),x=C(g),y=C(E),z=C(O),Z=C(w),W=C(R);f(_,A);var k=function(n,e){var r=!0,t=u();t.current?r=!!(e&&t.current.deps&&p(e,t.current.deps)):t.current={deps:e,result:n()};var o=r?t.current:{deps:e,result:n()};return t.current=o,o.result}((function(){return n=S,Object.entries(n).reduce((function(n,e){var a=r(e,2),u=a[0],l=a[1];return t(t({},n),{},o({},"data-".concat(u.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()),l))}),{});var n}),[S]);return s((function(){return P&&(window.UPLOADCARE_LOCALE=P),T&&(window.UPLOADCARE_LOCALE_PLURALIZE=T),b&&(window.UPLOADCARE_LOCALE_TRANSLATIONS=b),I&&(window.UPLOADCARE_PREVIEW_URL_CALLBACK=I),A.plugin((function(n){n.locale.rebuild({locale:P||null,localeTranslations:b||null,localePluralize:T||null})})),function(){P&&delete window.UPLOADCARE_LOCALE,T&&delete window.UPLOADCARE_LOCALE_PLURALIZE,b&&delete window.UPLOADCARE_LOCALE_TRANSLATIONS,I&&delete window.UPLOADCARE_PREVIEW_URL_CALLBACK}}),[P,b,T,I]),l((function(){j.current=A.Widget(N.current);var n=N.current.nextSibling;return function(){return n&&n.parentNode.removeChild(n)}}),[A,k]),function(n,e){l((function(){if(null!=e){var r=n.current;return e.forEach((function(n){r.validators.push(n)})),function(){r.validators.length=0}}}),[n,e])}(j,D),l((function(){return j.current.onUploadComplete.add(y),j.current.onChange.add(x),function(){j.current.onUploadComplete.remove(y),j.current.onChange.remove(x)}}),[y,x,A,k]),l((function(){var n,e=function(e){(n=e).done(Z).fail(Z).progress(W),z(e)};return j.current.onDialogOpen.add(e),function(){j.current.onDialogOpen.remove(e),n&&n.reject()}}),[k,Z,z,W]),l((function(){var n=[],e=function(e){n=e?e.files?e.files():[e]:[]};return j.current.onChange.add(e),function(){n.forEach((function(n){return n.cancel()})),j.current.onChange.remove(e)}}),[k]),l((function(){j.current.value(m)}),[m]),l((function(){A&&h&&"string"==typeof h&&(0===h.indexOf("https://")?A.tabsCss.addUrl(h):A.tabsCss.addStyle(h))}),[A,h]),i(U,(function(){return{openDialog:function(){return j.current.openDialog()},reloadInfo:function(){return j.current.reloadInfo()},getInput:function(){return j.current.inputElement}}}),[]),c((function(){return a.createElement("input",n({type:"hidden",ref:N,id:L,name:v},k))}),[k,L,v])};export default function(n){var e=A(n,d);return a.createElement(e,null)}
